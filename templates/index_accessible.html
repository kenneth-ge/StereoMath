<!DOCTYPE HTML>
<html>
    <head>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mathquill/0.10.1/mathquill.css" integrity="sha512-vPg9GqsZZ4LHv9BkFfZSXt7y4D7YaARPU2JFmpZug4EgtJJrumytMAFZkNSk2LSyqWir0TNbh2tBq7UJIMxvlA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathquill/0.10.1/mathquill.min.js" integrity="sha512-Qsh05D07P6dURSZn8Qk+j8GI7cEK0OhXleZvTofmucwoDSkBC0juWf1401JdSE8os2kWEezMu7e9mlnszm3yEw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <link rel="stylesheet" href="{{ url_for('static', filename='toolbar.css') }}" />
        <link rel="stylesheet" href="{{ url_for('static', filename='accessible-autocomplete.min.css') }}" />
        <script type="text/javascript" src="{{ url_for('static', filename='accessible-autocomplete.min.js') }}"></script>
    </head>
    <body>
        <form id="myForm">
            <select id="equation-picker">
                <option selected="true" style='display: none'></option>
                <option value="integral">integral</option>
                <option value="cos">cos</option>
              </select>
            <br>
            <label for="output">Output:</label>
            <input type="text" id="output" name="output" required>
            <br>
            <button type="button" onclick="submitForm()">Submit</button>
        </form>
        <script type="text/javascript" src="{{ url_for('static', filename='accessible_index.js') }}"></script>

        <table class="toolbar">
            <tr>
                <td>Insert:</td>
                <td class="menu">
                    <p aria-haspopup="true" role="button" tabindex="0" id="power" aria-label="to the power of"><span class="mathquill-embedded-latex">x^y</span><code>^{}</code></p>
                        <div aria-hidden="true" aria-label="submenu">
                            <p role="button" tabindex="0" aria-label="subscript"><span class="mathquill-embedded-latex">x_y</span>
                                <code>_{}</code></p>
                        </div>
                </td>
                <td class="menu">
                    <p role="button" tabindex="0" aria-label="parentheses"><span class="mathquill-embedded-latex">\left(\right)</span><code>\left(\right)</code></p>
                        <div>
                            <p role="button" tabindex="0" aria-label="absolute value"><span class="mathquill-embedded-latex">|</span><span class="box">&nbsp;&nbsp;</span><span class="mathquill-embedded-latex">|</span>
                                <code>\left|\right|</code></p>
                            <p role="button" tabindex="0" aria-label="brackets"><span class="mathquill-embedded-latex">[</span><span class="box">&nbsp;&nbsp;</span><span class="mathquill-embedded-latex">]</span>
                                <code>\left[\right]</code></p>
                            <p role="button" tabindex="0" aria-label="curly braces"><span>{</span><span class="box">&nbsp;&nbsp;</span><span>}</span>
                                <code>\left\{\right\}</code></p>
                            <p role="button" tabindex="0" aria-label="floor"><span class="mathquill-embedded-latex">\lfloor</span><span class="box">&nbsp;&nbsp;</span><span class="mathquill-embedded-latex">\rfloor</span>
                                <code>\lfloor\rfloor</code></p>
                            <p role="button" tabindex="0" aria-label="ceiling"><span class="mathquill-embedded-latex">\lceil</span><span class="box">&nbsp;&nbsp;</span><span class="mathquill-embedded-latex">\rceil</span>
                                <code>\lceil\rceil</code></p>
                        </div>
                </td>
                <td class="button">
                    <p role="button" tabindex="0" aria-label="fraction"><span class="mathquill-embedded-latex" style="position:relative;top:-.35em">\frac{}{}</span><code>\frac{}{}</code></p>
                </td>
                <td class="menu">
                    <p role="button" tabindex="0" aria-label="square root"><span class="mathquill-embedded-latex">\sqrt{}</span><code>\sqrt{}</code></p>
                    <div><p role="button" tabindex="0" aria-label="nth root"><span class="mathquill-embedded-latex">\sqrt[]{}</span><code>\sqrt[]{}</code></p></div>
                </td>
                <td class="button">
                    <p role="button" tabindex="0" aria-label="binomial of n choose k"><span class="mathquill-embedded-latex" style="position:relative;top:-.5em">\binom nk</span><code>\binom nk</code></p>
                </td>
                <td class="menu">
                    <p role="button" tabindex="0" aria-label="delta"><span class="mathquill-embedded-latex">\del</span><code>\del</code></p>
                        <div>
                            <p role="button" tabindex="0" aria-label="partial"><span class="mathquill-embedded-latex">\part</span><code>\part</code></p>
                        </div>
                </td>
                <td class="menu">
                    <p role="button" tabindex="0" aria-label="integral"><span class="mathquill-embedded-latex">\int</span><code>\int</code></p>
                        <div>
                            <p role="button" tabindex="0" aria-label="sum"><span class="mathquill-embedded-latex">\sum</span><code>\sum</code></p>
                            <p role="button" tabindex="0" aria-label="product"><span class="mathquill-embedded-latex">\prod</span><code>\prod</code></p>
                            <p role="button" tabindex="0" aria-label="coproduct"><span class="mathquill-embedded-latex">\coprod</span><code>\coprod</code></p>
                            <p role="button" tabindex="0" aria-label="limit as x goes to 2"><span class="mathquill-embedded-latex">\lim_{x \to 2}</span><code>\lim_{x \to 2}</code></p>
                        </div>
                </td>
                <td class="menu">
                    <p role="button" tabindex="0" aria-label="division symbol"><span class="mathquill-embedded-latex">\div</span><code>\div</code></p>
                        <div>
                            <p role="button" tabindex="0" aria-label="times or cross product"><span class="mathquill-embedded-latex">\times</span>
                                <code>\times</code></p>
                            <p role="button" tabindex="0" aria-label="dot"><span class="mathquill-embedded-latex">\cdot</span>
                                <code>*</code></p>
                            <p role="button" tabindex="0" aria-label="plus or minus"><span class="mathquill-embedded-latex">\pm</span>
                                <code>\pm</code></p>
                            <p role="button" tabindex="0" aria-label="minus or plus"><span class="mathquill-embedded-latex">\mp</span>
                                <code>\mp</code></p>
                        </div>
                </td>
                <td class="menu">
                    <p role="button" tabindex="0" aria-label="not equal to"><span class="mathquill-embedded-latex">\ne</span><code>\ne</code></p>
                        <div>
                            <p role="button" tabindex="0" aria-label="less than or equal to"><span class="mathquill-embedded-latex">\le</span>
                                <code>\le</code></p>
                            <p role="button" tabindex="0" aria-label="greater than or equal to"><span class="mathquill-embedded-latex">\ge</span>
                                <code>\ge</code></p>
                            <p role="button" tabindex="0" aria-label="approximately equal to"><span class="mathquill-embedded-latex">\asymp</span>
                                <code>\asymp</code></p>
                            <p role="button" tabindex="0" aria-label="congruent to"><span class="mathquill-embedded-latex">\cong</span>
                                <code>\cong</code></p>
                            <p role="button" tabindex="0" aria-label="equivalent to"><span class="mathquill-embedded-latex">\equiv</span>
                                <code>\equiv</code></p>
                        </div>
                </td>
                <td class="menu">
                    <p role="button" tabindex="0" aria-label="pi"><span class="mathquill-embedded-latex">\pi</span><code>\pi</code></p>
                        <div>
                            <p role="button" tabindex="0" aria-label="theta"><span class="mathquill-embedded-latex">\theta</span>
                                <code>\theta</code></p>
                            <p role="button" tabindex="0" aria-label="infinity"><span class="mathquill-embedded-latex">\infty</span>
                                <code>\infty</code></p>
                            <p role="button" tabindex="0" aria-label="hbar"><span class="mathquill-embedded-latex">\hbar</span>
                                <code>\hbar</code></p>
                            <p role="button" tabindex="0" aria-label="degree"><span class="mathquill-embedded-latex">\deg</span>
                                <code>\deg</code></p>
                            <p role="button" tabindex="0" aria-label="degree symbol"><span class="mathquill-embedded-latex">\degree</span>
                                    <code>\degree</code></p>
                            <p role="button" tabindex="0" aria-label="Angstrom"><span class="mathquill-embedded-latex">\AA</span>
                                <code>\AA</code></p>
                        </div>
                </td>
                <td class="menu">
                    <p role="button" tabindex="0" aria-label="sin"><span class="mathquill-embedded-latex">\sin\left(\right)</span><code>\sin\left(\right)</code></p>
                    <div>
                        <p role="button" tabindex="0" aria-label="cos"><span class="mathquill-embedded-latex">\cos\left(\right)</span><code>\cos\left(\right)</code></p>
                        <p role="button" tabindex="0" aria-label="tangent"><span class="mathquill-embedded-latex">\tan\left(\right)</span><code>\tan\left(\right)</code></p>
                        <p role="button" tabindex="0" aria-label="arcsin"><span class="mathquill-embedded-latex">\arcsin\left(\right)</span><code>\arcsin\left(\right)</code></p>
                        <p role="button" tabindex="0" aria-label="arccos"><span class="mathquill-embedded-latex">\arccos\left(\right)</span><code>\arccos\left(\right)</code></p>
                        <p role="button" tabindex="0" aria-label="arctan"><span class="mathquill-embedded-latex">\arctan\left(\right)</span><code>\arctan\left(\right)</code></p>
                    </div>
                </td>
                <td class="menu">
                    <p role="button" tabindex="0" aria-label="natural log"><span class="mathquill-embedded-latex">\ln\left(\right)</span><code>\ln\left(\right)</code></p>
                    <div>
                        <p role="button" tabindex="0" aria-label="log"><span class="mathquill-embedded-latex">\log\left(\right)</span><code>\log\left(\right)</code></p>
                    </div>
                </td>
            </tr>
        </table>
        <script>
            var MQ = MathQuill.getInterface(2);
            var answerSpan = document.getElementById('latex');
            var answerMathField = MQ.MathField(answerSpan, {
                handlers: {
                    edit: function() {
                        var enteredMath = answerMathField.latex(); // Get entered math in LaTeX format
                        console.log(enteredMath)
                    }
                }
            });
        </script>
        <script src="{{ url_for('static', filename='index.js') }}"></script>
<script type="text/javascript">
    var ed = answerMathField

    var items = document.querySelectorAll('.mathquill-embedded-latex');
    items.forEach(item => {
        MQ.StaticMath(item);
    });

    items = document.querySelectorAll('table div');
    items.forEach(item => {
        item.classList.add('hidden');
    });

    $(document).ready(function () {
        $('td').mouseenter(function () {
            //ed.redraw();
        });
        /*setTimeout(function () {
            $('.mathquill-rendered-math').mathquill('redraw');
        }, 1000);*/
    });

    $('.toolbar').click(function (e) {
        var latex = $(e.target).closest('p').children('code').text();
        if (latex){
            console.log(latex)
            ed.write(latex).focus();
        }
    });
    $('.toolbar').keydown(function (e) {
        if (event.keyCode === 32) {
            event.preventDefault();
        }
        // If enter is pressed, activate the button
        else if (event.keyCode === 13) {
            event.preventDefault();
            var latex = $(e.target).closest('p').children('code').text();
            if (latex){
                console.log(latex)
                ed.write(latex).focus();
            }
        }
    });
    $('.toolbar').keyup(function (e) {
        if (event.keyCode === 32) {
            event.preventDefault();
            var latex = $(e.target).closest('p').children('code').text();
            if (latex){
                console.log(latex)
                ed.write(latex).focus();
            }
        }
    });
</script>
    </body>
</html>